{% extends 'dj_audit/base.html' %}

{% block title %}
Audit Logs
{% endblock %}

{% block additional_styles %}
<!-- <link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/jquery.dataTables.min.css"> -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.3/css/dataTables.bootstrap5.min.css">
{% endblock %}

{% block page_content %}
<div class="page_table mt-5 mb-5 ml-3 mr-3">
    <table id="audit_table" class="table table-bordered">
        <!-- table-striped -->
        <thead>
            <tr>
                <th>S/N</th>
                <th>Username</th>
                <th>IP Address</th>
                <th>User Agent</th>
                <th>Content Type</th>
                <th>Query String</th>
                <th>HTTP Method</th>
                <th>URL</th>
                <th>Response Status</th>
                <th>Attempt Time</th>
            </tr>
        </thead>
        <tbody>
            {% for audit in audit_logs %}
            <tr
                class="
                {% if audit.response_status_code >= 200 and audit.response_status_code < 400 %}
                table-success
                {% elif audit.response_status_code >= 400 and audit.response_status_code < 500 %}
                table-warning
                {% elif audit.response_status_code >= 500 %}
                table-danger
                {% endif %}"
            >
                <td>{{ forloop.counter }}</td>
                <td>{{ audit.user }}</td>
                <td>{{ audit.ip_address }}</td>
                <td>{{ audit.user_agent }}</td>
                <td>{{ audit.content_type }}</td>
                <td>{{ audit.query_string }}</td>
                <td>{{ audit.http_method }}</td>
                <td>{{ audit.path_info }}</td>
                <td>{{ audit.response_status_code }}</td>
                <td>{{ audit.attempt_time }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}

{% block additional_scripts %}
<script src="https://cdn.datatables.net/1.11.3/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.11.3/js/dataTables.bootstrap5.min.js"></script>
<script>
    $(document).ready(function () {
        $('#audit_table').DataTable({
            "pageLength": 50,
            "lengthChange": false
        });
    });
</script>
{% endblock %}
